<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Planner PRO Mobile - Mapas</title>
<style>
  :root{ --bg:#070707; --panel:#0f1113; --accent:#00eaff; --muted:#8b8b8b; }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family:Inter, system-ui, Arial; background:var(--bg); color:#fff; display:flex; flex-direction:column;}
  header{ display:flex; align-items:center; gap:12px; padding:12px 16px; background:linear-gradient(180deg,#0b0b0b,#0f1012); border-bottom:1px solid rgba(255,255,255,0.03); }
  .brand{ font-weight:700; color:var(--accent); font-size:16px }
  .hamburger{ width:44px; height:36px; display:flex; align-items:center; justify-content:center; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:#0b0b0c; cursor:pointer }
  .hamburger:active{ transform:scale(0.98) }
  .hamburger svg{ display:block }

  #sidebar{ width:86vw; max-width:380px; background:linear-gradient(180deg,#0b0b0b, #0f1012); border-right:1px solid rgba(255,255,255,0.03); padding:14px; overflow:auto; position:fixed; top:0; left:0; bottom:0; transform:translateX(-110%); transition:transform .28s ease; z-index:50;}
  #sidebar.show{ transform:translateX(0); }
  .overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.45); z-index:40; display:none;}
  .overlay.show{ display:block; }

  h2{margin:0 0 12px 0; font-size:18px; color:var(--accent)}
  .section{margin-bottom:16px; padding:10px; background:rgba(255,255,255,0.02); border-radius:8px}
  label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px}
  button, select, input[type="text"]{
    background:#0b0b0c; border:1px solid rgba(255,255,255,0.06); color:#fff; padding:10px 12px; border-radius:8px; font-size:13px; width:100%; margin-bottom:8px; cursor:pointer;
  }
  .row{display:flex; gap:8px}
  .small{padding:10px 12px; flex:1}
  .routes-list{display:flex; flex-direction:column; gap:6px}
  .route-item{display:flex; align-items:center; gap:8px; padding:6px; background:rgba(255,255,255,0.02); border-radius:6px}
  .color-box{width:14px; height:14px; border-radius:3px; border:1px solid rgba(255,255,255,0.06)}
  .labelName{font-weight:600; font-size:14px}
  #main{ flex:1; display:flex; flex-direction:column; align-items:center; padding:12px; overflow:auto; position:relative; }
  #mapWrap{ width:100%; max-width:100%; aspect-ratio:1/1; background:#000; border-radius:10px; position:relative; overflow:hidden; box-shadow:0 6px 30px rgba(0,0,0,0.6); }
  #mapImg{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; user-select:none; -webkit-user-drag:none}
  canvas{position:absolute; left:0; top:0; width:100%; height:100%}

  .tiny{font-size:12px; color:var(--muted)}

  /* Bot√£o flutuante */
  #btnFloatMap{
    position:absolute;
    top:10px;
    right:10px;
    background:var(--panel);
    border:1px solid rgba(255,255,255,0.1);
    color:#fff;
    padding:8px 10px;
    border-radius:8px;
    cursor:pointer;
    z-index:100;
    font-size:13px;
  }
  #btnFloatMap:active{ transform:scale(0.95); }
</style>
</head>
<body>
<header>
  <button id="hamburger" class="hamburger" aria-label="Abrir menu" aria-expanded="false">
    <svg width="20" height="14" viewBox="0 0 20 14" fill="none" xmlns="http://www.w3.org/2000/svg"><rect y="0" width="20" height="2" rx="1" fill="#fff"/><rect y="6" width="20" height="2" rx="1" fill="#fff"/><rect y="12" width="20" height="2" rx="1" fill="#fff"/></svg>
  </button>
  <div class="brand">Planner PRO</div>
</header>

<aside id="sidebar" role="navigation" aria-label="Painel de ferramentas">
  <h2>Planner PRO</h2>

  <div class="section">
    <label>Selecionar mapa</label>
    <select id="mapSelector">
      <option value="bermuda">Bermuda</option>
      <option value="map2">Mapa 2</option>
      <option value="map3">Mapa 3</option>
      <option value="map4">Mapa 4</option>
    </select>
    <button id="btnBackMap" style="margin-top:8px;">üîÑ Voltar √† sele√ß√£o de mapa</button>
  </div>

  <div class="section">
    <label>Rota ativa</label>
    <div class="row">
      <button id="btnR1" class="small">Rota 1</button>
      <button id="btnR2" class="small">Rota 2</button>
      <button id="btnR3" class="small">Rota 3</button>
      <button id="btnR4" class="small">Rota 4</button>
    </div>
    <input id="routeName" type="text" placeholder="Nome da rota" />
    <div class="row">
      <button id="rename" class="small">Renomear</button>
      <button id="clearRoute" class="small">Limpar rota</button>
    </div>
  </div>

  <div class="section">
    <label>Marcar ponto especial</label>
    <select id="specialType">
      <option value="loot">üì¶ Loot</option>
      <option value="car">üöó Ve√≠culo</option>
      <option value="weapon">üî´ Arma</option>
      <option value="sniper">üéØ Sniper spot</option>
      <option value="drop">üéÅ Drop</option>
    </select>
    <input id="specialName" type="text" placeholder="Nome do marcador" />
    <div class="row">
      <button id="addSpecialMode" class="small">Adicionar marcador</button>
      <button id="clearSpecials" class="small">Limpar marcadores</button>
    </div>
  </div>

  <div class="section">
    <label>Modo Squad (marcar jogadores)</label>
    <input id="playerName" type="text" placeholder="Nome do jogador" />
    <div class="row">
      <button id="addPlayerMode" class="small">Posicionar player</button>
      <button id="clearPlayers" class="small">Limpar players</button>
    </div>
  </div>

  <div class="section">
    <label>Replay / anima√ß√£o</label>
    <div class="row">
      <button id="replayAll" class="small">‚ñ∂Ô∏è Reproduzir tudo</button>
      <button id="stopReplay" class="small">‚èπÔ∏è Parar</button>
    </div>
  </div>

  <div class="section">
    <label>Salvar/Carregar</label>
    <div class="row">
      <button id="saveLocal" class="small">üíæ Salvar</button>
      <button id="loadLocal" class="small">üìÇ Carregar</button>
    </div>
    <div class="row">
      <button id="exportPNG" class="small">üì∏ Exportar PNG</button>
      <button id="importJSON" class="small">‚¨ÜÔ∏è Importar JSON</button>
    </div>
    <input id="importArea" type="text" placeholder="Cole JSON aqui"/>
  </div>

  <div style="height:40px"></div>
</aside>
<div id="overlay" class="overlay"></div>

<main id="main">
  <div id="mapWrap">
    <img id="mapImg" src="https://i.postimg.cc/Gm2jNsyB/Captura-de-tela-2025-10-10-152412.png" alt="Mapa Bermuda">
    <canvas id="canvas"></canvas>
    <div id="btnFloatMap">üîÑ Trocar mapa</div>
  </div>
</main>

<script>
/* ======= Vari√°veis e setup ======= */
const colors = { rota1:'#ff4d4d', rota2:'#4dd0ff', rota3:'#7cff6f', rota4:'#ffd64d' };
const routeIds = ['rota1','rota2','rota3','rota4'];
const routes = { rota1:[], rota2:[], rota3:[], rota4:[] };
const routeNames = { rota1:'Rota 1', rota2:'Rota 2', rota3:'Rota 3', rota4:'Rota 4' };
const specials = []; const players = [];
let activeRoute='rota1', addSpecialActive=false, addPlayerActive=false, measureActive=false, dragging=null, replayControllers=[];

const maps = {
  bermuda:{src:"https://i.postimg.cc/Gm2jNsyB/Captura-de-tela-2025-10-10-152412.png",routes:JSON.parse(JSON.stringify(routes)),specials:[],players:[]},
  map2:{src:"https://i.postimg.cc/XXXX/map2.png",routes:JSON.parse(JSON.stringify(routes)),specials:[],players:[]},
  map3:{src:"https://i.postimg.cc/XXXX/map3.png",routes:JSON.parse(JSON.stringify(routes)),specials:[],players:[]},
  map4:{src:"https://i.postimg.cc/XXXX/map4.png",routes:JSON.parse(JSON.stringify(routes)),specials:[],players:[]}
};
let activeMap='bermuda';

/* ======= Elementos ======= */
const hamburger = document.getElementById('hamburger');
const sidebar = document.getElementById('sidebar');
const overlay = document.getElementById('overlay');
const canvas = document.getElementById('canvas'), ctx=canvas.getContext('2d'), mapWrap=document.getElementById('mapWrap'), mapImg=document.getElementById('mapImg');

const btns = {
  r1: document.getElementById('btnR1'), r2: document.getElementById('btnR2'), r3: document.getElementById('btnR3'), r4: document.getElementById('btnR4'),
  rename: document.getElementById('rename'), routeName: document.getElementById('routeName'), clearRoute: document.getElementById('clearRoute'),
  addSpecialMode: document.getElementById('addSpecialMode'), specialType: document.getElementById('specialType'), specialName: document.getElementById('specialName'), clearSpecials: document.getElementById('clearSpecials'),
  addPlayerMode: document.getElementById('addPlayerMode'), playerName: document.getElementById('playerName'), clearPlayers: document.getElementById('clearPlayers'),
  replayAll: document.getElementById('replayAll'), stopReplay: document.getElementById('stopReplay'),
  saveLocal: document.getElementById('saveLocal'), loadLocal: document.getElementById('loadLocal'),
  exportPNG: document.getElementById('exportPNG'), importJSON: document.getElementById('importJSON'), importArea: document.getElementById('importArea')
};

const mapSelector = document.getElementById('mapSelector');
const btnBackMap = document.getElementById('btnBackMap');
const btnFloatMap = document.getElementById('btnFloatMap');

/* ======= Fun√ß√µes menu hamb√∫rguer ======= */
hamburger.addEventListener('click', ()=>{
  const opened = sidebar.classList.contains('show');
  if(opened){ sidebar.classList.remove('show'); overlay.classList.remove('show'); hamburger.setAttribute('aria-expanded','false'); }
  else{ sidebar.classList.add('show'); overlay.classList.add('show'); hamburger.setAttribute('aria-expanded','true'); }
});
overlay.addEventListener('click', ()=>{
  sidebar.classList.remove('show'); overlay.classList.remove('show'); hamburger.setAttribute('aria-expanded','false');
});

/* ======= Canvas ======= */
function resizeCanvas(){ canvas.width = mapWrap.clientWidth; canvas.height = mapWrap.clientHeight; drawAll(); }
window.addEventListener('resize', resizeCanvas); window.addEventListener('load', resizeCanvas);

/* ======= UI ======= */
function setActiveBtnVisual(){ [btns.r1,btns.r2,btns.r3,btns.r4].forEach((b,i)=>{ const id=routeIds[i]; b.style.border = id===activeRoute? `2px solid ${colors[id]}`:'1px solid rgba(255,255,255,0.06)'; }); btns.routeName.value=routeNames[activeRoute]; }
[btns.r1,btns.r2,btns.r3,btns.r4].forEach((b,i)=> b.addEventListener('click', ()=>{ activeRoute=routeIds[i]; setActiveBtnVisual(); drawAll(); sidebar.classList.remove('show'); overlay.classList.remove('show'); }));

btns.rename.addEventListener('click', ()=>{ const v=btns.routeName.value.trim(); if(v) routeNames[activeRoute]=v; drawAll(); setActiveBtnVisual(); });
btns.clearRoute.addEventListener('click', ()=>{ routes[activeRoute]=[]; drawAll(); });

btns.addSpecialMode.addEventListener('click', ()=>{ addSpecialActive=!addSpecialActive; addPlayerActive=false; measureActive=false; drawAll(); });
btns.clearSpecials.addEventListener('click', ()=>{ specials.length=0; drawAll(); });
btns.addPlayerMode.addEventListener('click', ()=>{ addPlayerActive=!addPlayerActive; addSpecialActive=false; measureActive=false; drawAll(); });
btns.clearPlayers.addEventListener('click', ()=>{ players.length=0; drawAll(); });

function distance(a,b){ return Math.hypot(a.x-b.x,a.y-b.y); }

/* ======= Map interactions ======= */
mapWrap.addEventListener('pointerdown', ev=>{
  const rect=canvas.getBoundingClientRect(); const x=ev.clientX-rect.left, y=ev.clientY-rect.top;
  if(addSpecialActive){ specials.push({x,y,type:btns.specialType.value,name:btns.specialName.value||''}); drawAll(); return; }
  if(addPlayerActive){ const pname=btns.playerName.value.trim()||`Player${players.length+1}`; players.push({x,y,name:pname,color:colors[activeRoute]}); drawAll(); return; }

  // Drag
  for(let i=players.length-1;i>=0;i--){ if(distance(players[i],{x,y})<14){ dragging={type:'player',index:i}; return; } }
  for(let i=specials.length-1;i>=0;i--){ if(distance(specials[i],{x,y})<14){ dragging={type:'special',index:i}; return; } }
  const pts=routes[activeRoute];
  for(let i=0;i<pts.length;i++){ if(distance(pts[i],{x,y})<12){ dragging={type:'route',index:i}; return; } }
  if(ev.button===0){ routes[activeRoute].push({x,y}); drawAll(); }
});
window.addEventListener('pointermove', ev=>{ if(!dragging) return; const rect=canvas.getBoundingClientRect(); const x=ev.clientX-rect.left, y=ev.clientY-rect.top; if(dragging.type==='player'){ players[dragging.index].x=x; players[dragging.index].y=y; } if(dragging.type==='special'){ specials[dragging.index].x=x; specials[dragging.index].y=y; } if(dragging.type==='route'){ routes[activeRoute][dragging.index].x=x; routes[activeRoute][dragging.index].y=y; } drawAll(); });
window.addEventListener('pointerup', ()=> dragging=null);

/* ======= Drawing ======= */
function drawAll(){ ctx.clearRect(0,0,canvas.width,canvas.height); drawGrid(); routeIds.forEach(id=>drawRoute(routes[id],colors[id],routeNames[id])); specials.forEach(drawSpecial); players.forEach(drawPlayer); }
function drawGrid(){ const step=80; ctx.save(); ctx.strokeStyle='rgba(255,255,255,0.03)'; ctx.lineWidth=1; for(let x=0;x<canvas.width;x+=step){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke(); } for(let y=0;y<canvas.height;y+=step){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke(); } ctx.restore(); }
function drawRoute(points,color,name){ if(!points||points.length===0)return; ctx.save(); ctx.strokeStyle=color; ctx.lineWidth=3; ctx.lineJoin='round'; ctx.lineCap='round'; ctx.beginPath(); ctx.moveTo(points[0].x,points[0].y); for(let i=1;i<points.length;i++) ctx.lineTo(points[i].x,points[i].y); ctx.stroke(); for(let i=0;i<points.length;i++){ const p=points[i]; ctx.beginPath(); ctx.fillStyle=color; ctx.arc(p.x,p.y,6,0,Math.PI*2); ctx.fill(); ctx.fillStyle='#fff'; ctx.font='12px Arial'; ctx.fillText((i+1),p.x+8,p.y-8); } ctx.fillStyle=color; ctx.font='bold 13px Arial'; ctx.fillText(name,points[0].x+10,points[0].y+20); ctx.restore(); }
function drawSpecial(s){ ctx.save(); ctx.beginPath(); ctx.fillStyle='rgba(0,0,0,0.6)'; ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.arc(s.x,s.y,12,0,Math.PI*2); ctx.fill(); ctx.stroke(); let emoji='‚ùì'; if(s.type==='loot') emoji='üì¶'; if(s.type==='car') emoji='üöó'; if(s.type==='weapon') emoji='üî´'; if(s.type==='sniper') emoji='üéØ'; if(s.type==='drop') emoji='üéÅ'; ctx.font='16px Arial'; ctx.fillStyle='#fff'; ctx.fillText(emoji,s.x-8,s.y+6); if(s.name){ ctx.font='12px Arial'; ctx.fillText(s.name,s.x+16,s.y+6); } ctx.restore(); }
function drawPlayer(p){ ctx.save(); ctx.beginPath(); ctx.fillStyle=p.color; ctx.arc(p.x,p.y,10,0,Math.PI*2); ctx.fill(); ctx.fillStyle='#fff'; ctx.font='12px Arial'; ctx.fillText(p.name,p.x+14,p.y+4); ctx.restore(); }

/* ======= Replay ======= */
btns.replayAll.addEventListener('click',()=>{ replayControllers.forEach(c=>clearInterval(c)); replayControllers=[]; routeIds.forEach(id=>{ let pts=routes[id]; if(!pts||pts.length<2)return; let idx=1; const interval=setInterval(()=>{ drawAll(); ctx.beginPath(); ctx.strokeStyle=colors[id]; ctx.lineWidth=4; ctx.moveTo(pts[0].x,pts[0].y); for(let i=1;i<=idx;i++) ctx.lineTo(pts[i].x,pts[i].y); ctx.stroke(); idx++; if(idx>=pts.length) clearInterval(interval); },250); replayControllers.push(interval); }); });
btns.stopReplay.addEventListener('click',()=>{ replayControllers.forEach(c=>clearInterval(c)); replayControllers=[]; drawAll(); });

/* ======= Save/load/export/import ======= */
btns.saveLocal.addEventListener('click',()=>{ const data={routes,routeNames,specials,players}; localStorage.setItem('plannerData',JSON.stringify(data)); alert('Salvo localmente!'); });
btns.loadLocal.addEventListener('click',()=>{ const data=JSON.parse(localStorage.getItem('plannerData')||'{}'); if(data.routes) Object.assign(routes,data.routes); if(data.routeNames) Object.assign(routeNames,data.routeNames); if(data.specials) specials.splice(0,specials.length,...data.specials); if(data.players) players.splice(0,players.length,...data.players); drawAll(); setActiveBtnVisual(); });

btns.exportPNG.addEventListener('click',()=>{ const link=document.createElement('a'); link.download='planner.png'; link.href=canvas.toDataURL(); link.click(); });
btns.importJSON.addEventListener('click',()=>{ try{ const data=JSON.parse(btns.importArea.value); if(data.routes) Object.assign(routes,data.routes); if(data.routeNames) Object.assign(routeNames,data.routeNames); if(data.specials) specials.splice(0,specials.length,...data.specials); if(data.players) players.splice(0,players.length,...data.players); drawAll(); setActiveBtnVisual(); alert('Importado com sucesso!'); }catch(e){alert('JSON inv√°lido')} });

/* ======= Trocar mapa ======= */
function changeMap(name){
  if(!maps[name]) return;
  activeMap=name;
  mapImg.src=maps[name].src;
  Object.assign(routes,maps[name].routes);
  specials.splice(0,specials.length,...maps[name].specials);
  players.splice(0,players.length,...maps[name].players);
  drawAll();
  sidebar.classList.remove('show'); overlay.classList.remove('show');
}
mapSelector.addEventListener('change', ()=>{ changeMap(mapSelector.value); });
btnBackMap.addEventListener('click', ()=>{ sidebar.classList.add('show'); overlay.classList.add('show'); hamburger.setAttribute('aria-expanded','true'); });
btnFloatMap.addEventListener('click', ()=>{ sidebar.classList.add('show'); overlay.classList.add('show'); hamburger.setAttribute('aria-expanded','true'); });

setActiveBtnVisual();
drawAll();
</script>
</body>
</html>
